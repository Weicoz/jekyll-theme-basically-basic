{% if jekyll.environment == 'production' and site.google_analytics %}
  {% include google-analytics.html %}
{% endif %}

<style type="text/css">
    li {list-style-type: none;}
    ul {margin: 0;}
    .inner{max-width:1440px;}
    .sidebar-toggle-wrapper {
        cursor: auto;
    }
    .site-title{padding-right: calc(15vw + 1.75em);}
    .search_logo{
        transition: 300ms;
        float: left;
        margin: 0.9rem 0;
        padding: 0.3rem;
        font-size: 1.7rem;
    }
    .search_button{
        cursor: pointer;
    }
    .search{
        transition: 300ms;
        display: none;
        position: absolute;
        top: 4rem;
        padding: 0.7rem;
        right: 0px;
        font-size: 0.9rem;
        min-width: 220px;
        line-height: 1.5;
    }
    .search input{
        border:0;
        transition: 300ms;
        line-height: 1.5;
        padding: 0.7rem;
        display: block;
        float: right;
        width: 200px;
        border-radius: .6rem;
    }
    .search ul.search_list{
        transition: 300ms;
        padding: 0;
        margin-top:.3rem;
        background: #ededed;
        float: right;
        min-width: 200px;
        max-width: 1900px;
        max-height:600px;
        overflow-y:auto;
        text-overflow:ellipsis;
        white-space: nowrap;
        border-radius: .6rem;
    }
    .search li {
        transition: 300ms;
        display: block;
        float: left;
        width: 100%;
    }
    .search a{
        transition: 300ms;
        display: block;
        padding: 0.7rem;
        min-width: 200px;
        word-break: keep-all;
        float: left;
        text-decoration: none;
        width:100%;
    }
    .search li:hover {background: #00848a;}
    .search li:hover a{color:#fff;}

</style>

<script src="{{ '/assets/javascripts/jquery-1.12.1.min.js' | relative_url }}"></script>
<script src="{{ '/assets/javascripts/get.js' | relative_url }}"></script>
<script async src="{{ '/assets/javascripts/main.js' | relative_url }}"></script>

<script>

    var data = {
        page_url: '{{ page.url }}',
        escape: '{{ escape }}',
    }
    console.log(data);

    $(function(){
        $(".search_button").click(function(){
            $(".search").toggle(200);
            $(".search input").onfocus;
        });
        $.ajax({
            url: '/search/index.html',
            dataType: "text",
            success:function(data){
                $(".search_data").html(data);
                $(".search_data").html($("post_data").html());
                $("#post_data content").each(function(index,elm){
                    $(elm).html($(elm).text());
                })
           }
        });

        $("#keyword").focus(function(){
            $(".search ul").show(400);
        });

        $(".search").blur(function(){
            $(".search").hide(400);
        })

    });

    function search_keyword(){
        var keyword = $("#keyword").val();
        keyword = keyword.replace(/(^\s*)|(\s*$)/g, "");

        console.log(keyword);

        var data = "";
        var title = "";
        var url = "";
        if (keyword != ""){
            $("#post_data > article").each(function(index,elm){
                title = $(elm).find("title").text();
                content = $(elm).find("content").text();
                url = $(elm).find("url").text();
                if (title.indexOf(keyword) != -1){
                    data += '<li data-index="'+index+'"><a href="'+url+'" alt="'+title+'">'+title+'</a></li>';
                }else if (content.indexOf(keyword) != -1){
                    data += '<li data-index="'+index+'"><a href="'+url+'" alt="'+title+'">'+title+'</a></li>';
                }
            });
        }
        $(".search_list").html(data);
    }
</script>

